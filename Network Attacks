https://wiki.skullsecurity.org/index.php/Passwords

THC Hydra:
> -L    // list of usernames in file
> -P    // list of passwords in file
> -l    // list of usernames, separated via comma
> -p    // list of passwords, separated via comma
> -t    // Tasks per host
> -U    // Service moduledetails
> -M    // multible Hosts to attack

Crack HTTP form:
> Login Form:
  > look for method: GET or POST
  > look for name parameter
  
http-post-form:
> hydra -U http-post-form
> hydra <URL> <service http-post-form> 
  <login page "/login.php">:<user parameter "usr=">^USER^&<pass parameter "pass">^PASS^:<failed string - invalid credentials> -P <password list> -f <stop when creds found> -V   
> hydra <ip> ssh -L <user file> -P <password file>

nmap ssh-brute:
> nmap -p 22 --script ssh-brute --script-args userdb=user.txt,/usr/share/nmap/nselib/data/passwords.lst <target>

msfconsole ssh brute force:
> msfconsole -q
> use auxiliary/scanner/ssh/ssh_login
> set rhosts
> set username
> set pass_file
> set verbose true
> set stop_on_success true
> stop_on_success => true
> run

Windows Shares:
------------------
NetBIOS:
> used to view network shares on the local area network
> provides information:
  > Hostname
  > NetBIOS Name
  > Domain
  > Network Shares
> Ports:
  > NetBIOS NameauflÃ¶sung - UDP 137
  > Datagram Service      - UDP 138
  > Session Service       - TCP 139
  > ab Win ME: NBT        - TCP 445
> Universal Naming Convention paths:
  > \\Servername\ShareName\file.nat
> administrive shares:
  > \\Computername\C$       // volume on local machine
  > \\Computername\admin$   // install directory
  > \\Computername\ipc$     // inter-process communication
  
Null Session:
------------------
https://www.samba.org/
> can steal:
  > Passwords
  > System groups
  > System users
  > Running system processes
> nowadays configured to be immune, but legacy hosts can still be vulnerable
> login without any authentication

> Windows tool nbtstat:
  > nbtstat -A <IP>
    > <00> = workstation
    > WORKGROUP Name
    > <20> = file share is up and running
  > NET VIEW <IP>
    > Share Names with type Disk

> Linux tool nmblookup:
  > nmblookup -A <IP>
  > smbclient -L //<IP> -N              // L look for available services, N forces to use no password
    > show hidden admistrative shares, not like nbtstat
    > File and Printer Shares are interesting
  > Exploit the $IPC administrative share with Null Session
    Windows:
    > NET USE \\<IP>\IPC$ '' /u:''
    Linux:
    > smbclient //<IP>/IPC$ -N
    > enum4linux <ip>
      -U <IP>      // Users
      -S <IP>      // Shares
      -P <IP>      // Password Policy
      -n           // Null Session
      -s           // test shares
    > samrdump.py
      > samrdump.py <IP>
  > !!! every share must be tested separately !!!
    Enum Tool for Windows:
    https://packetstormsecurity.com/search/?q=win32+enum&s=files
    > enum -S <IP>      // Shares
    > enum -U <IP>      // Users
    > enum -P <IP>      // Password Policy
    https://packetstormsecurity.com/search/?q=winfo&s=files
    > winfo <IP> -n     // test Null Session
    
  > nmap Scan for Windows Shares:
    > -sS -p 135,139,445
    > --script=smb-enum-shares
    > --script=smb-enum-users
    > --script=smb-brute
    


